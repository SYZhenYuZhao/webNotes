<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #AAA {
            width: 100%;
            height: 100%;
            position: fixed;
            margin: auto;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: red;
            opacity: 0.6;
            color: black;
        }
    </style>
</head>
<body>
    <div id='AAA'>123</div> 
</body>
</html>
<script>
    /*
        DATE:2018-05-09
        author:SYzhaozhenyu
        content:对于touch事件的简单封装
    */
    let target = document.getElementById('AAA');

    //必要参数 target目标节点  type滑动方向  callback回调函数
    function Move (target,type,callback) {
        if(!target){
            throw 'target is required';
            return;
        }
        if(!type){
            throw 'type is required';
            return;
        }
        if(!callback){
            throw 'callback is required';
            return;
        }
        this.startx;
        this.endx;
        this.target = target;
        this.type = type;
        this.callback = callback;
        // console.log(tar)
        this.addListener()
    }

    Move.prototype.addListener = function(){
        let me = this;

        me.target.addEventListener('touchstart', function (e) {
            let touch = e.changedTouches;
            //只取第一个触点
            me.startx = touch[0].clientX;
            me.starty = touch[0].clientY;
            console.log(me.startx, me.starty, 'start') 
            console.log(e,'start')
        });
        me.target.addEventListener('touchend', function (e) {
            let touch = e.changedTouches;
            me.endx = touch[0].clientX;
            me.endy = touch[0].clientY;
            //cons();  //startx endx 的数据收集应该放在touchend事件后执行，而不是放在touchstart事件里执行，这样才能访问到touchstart和touchend这2个事件产生的startx和endx数据。另外startx和endx在_touch事件函数里是全局性的，所以在此函数中都可以访问得到，所以只需要注意事件执行的先后顺序即可。
            console.log(me.endx, me.endy, 'end')
            me.handlerDirection()
        });
    }
    Move.prototype.handlerDirection = function(){
        let {startx,endx,type,callback} = this;
        if (startx && endx) {
            if(type==='left'){
                if (startx - endx > 10) {
                    callback()
                }
                return; 
            }
            if(type==='right'){
                if (startx - endx < -10) {
                    callback()
                }
                return;
            }
        }
    }

    new Move(target,'left',function(){
        alert('left')
    })


  
</script>