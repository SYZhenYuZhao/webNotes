# 前后端渲染之争

## 近些年来出现的渲染方式

- 1、传统的后端渲染

> 后端渲染通常指的是传统的ASP、Java或PHP的渲染机制，加载的时候返回一个HTML文档

- 2、2014 同构渲染

> 同构渲染指前后端共用JS，首次渲染是使用Node.js来指出HTML，一般来说同构渲染是介于前后端中的共有部分。

- 3、前端渲染

> 前端渲染指使用JS来渲染页面大部分内容，代表是现在流行的SPA单页面应用，通常这个时候后端会给前端多个数据接口

## 前端渲染的优势

- 1、局部刷新。无需每次都进行完整页面请求
- 2、懒加载。如在页面初始时只加载可视区域内的数据，滚动后rp加载其他数据，可以通过 react-lazyload 实现
- 3、富交互。使用JS实现各种酷炫效果
- 4、节约服务器成本。减少占用服务器的空间，JS支持CDN部署，且部署十分简单，只需要服务器支持静态文件即可
- 5、天生的关注分离设计。服务器来访问数据库提供接口，JS只关注数据获取和展现
- 6、JS使用范围广发，可以用来开发Web、Serve、Mobile、DeskTOP类型的应用

### 前端渲染主要遇到的问题

> 前端渲染主要遇到的问题有前端渲染对SEO不友好、首屏加载过慢

#### 对SEO不友好的原因

> 对SEO不友好。是由于传统搜索引擎，只会从HTML里面抓取数据。而前端渲染中的数据是通过发送请求从后端的api中读取来的，也就是说在SEO爬去HTML的时候，我们还没有将API中的数据渲染进HTML页面中。

#### 首屏加载过慢的原因

> 前端渲染经常使用，单页面应用（SPA）会把所有JS整体打包，无法忽视的问题就是文件包过大，导致渲染前加载JS的时间很长，特别网速不好的情况下，需要很长的等待时间

### 前端渲染首屏优化的解决办法

- 1、分拆打包(按需加载)
> 现在流行的react-router对**拆分打包**都有很好的支持。可以按照页面进行**拆分打包JS文件**，在页面切换时加上一些loading和transition效果
- 2、交互优化
- 3、部分同构

## 后端渲染的优势

- 1、服务端渲染不需要先下载一堆js和css后才能看到页面（首屏性能）
- 2、后端渲染SEO效果好，因为内容适合页面同时渲染出来的
- 3、服务端渲染不用关心浏览器兼容性问题（随意浏览器发展，这个优点逐渐消失）
- 4、减少在客户端的电量消耗很重要

> 以上服务端优势，仅仅只有首屏性能和SEO两点比较突出，但是现在这两点已经慢慢变得微不足道了。React这类支持同构的框架已经能解决这个问题

## 同构的优点

- 1、有助于SEO
- 2、共用前端代码，节省开发时间（部分前端代码可以拿到后端去执行，但是同构需要为后端node.js去做一些兼容这个地方成本很高）
- 3、提高首屏性能

## 同构的缺点

- 1、性能
- 2、不容忽视的服务器端和浏览器环境差异

例如

> - document等对象找不到的问题 
> - DOM计算报错的问题
> - 前端渲染和服务端渲染内容不一致的问题

- 3、内存溢出
- 4、异步操作
- 5、simple store(redux)

## 总结

> 我们赞成客户端渲染是未来的主要方向，服务端则会专注于在数据和业务处理上的优势。但由于日趋复杂的软硬件环境和用户体验更高的追求，也不能只拘泥于完全的客户端渲染。同构渲染看似美好，但以目前的发展程度来看，在大型项目中还不具有足够的应用价值，但不妨碍部分使用来优化首屏性能。做同构之前 ，一定要考虑到浏览器和服务器的环境差异，站在更高层面考虑。